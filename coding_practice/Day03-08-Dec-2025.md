## ðŸ”¹ Ansible â€” Create User
----
name: create Pathnex user
hosts: all          #run in all inventory
become: yes         #give sudo access

tasks:
  name: create user pathnex admin
  user:
    name: pathnex-admin
    shell: /bin/bash

## ðŸ”¹ Terraform â€” Security Group (r6i.4xlarge EC2)

provider "aws" {
    region ="sa-east-1"
}
resource "aws_security_group" "Pathnex5G" {
  name = "Pathnex5G"
  description =" Pathnex 5G for SSH"

    ingress {
        from_port = 22
        to_port = 22
        protocol ="tcp"
        cidr_blocks =["0.0.0.0/0"]
    }
}
 resource "aws_instance" "PathnexEC2" {
   ami ="ami-0625244273"
   instance_type ="r6i.4xlarge"
   vpc_security_group_ids =[aws_security_group.Pathnex5G.id]   
   
   tags = {
    Name ="Pathnex-EC2"
   }
 }

## ðŸ”¹ Kubernetes â€” Add Environment Variables
apiVersion: v1
kind: Pod
metadata:
  name: pathnex-env-pod
spec: 
  containers: 
    - name: app
      image: nginx
      env:                      # echo $APP_ENV will give you value APP_ENV=production
        - name: APP_ENV         # Env variables used to put value inside your app in this case
          value: "production"   # container

## ðŸ”¹ Shell Script â€” Check File Exists
#! /bin/bash            # This tells the system to run the script using bash
FILE="/tmp/pathnex.txt"  # Set the file path

if [ -f "$FILE" ]; then   # Check if a regular file exists at this path
  echo "file_exists"
else 
  echo "file does not exists"
fi                              # This is the end of the if block

# NodeJS Build
## ðŸ”¹ Jenkins Pipeline â€” NodeJS Build
You will learn how to **install dependencies, run tests, and build a NodeJS project**.

pipeline {
    agent any       #Jenkins to run this pipeline on any available agent/node.
    tools {
        nodejs 'NodeJS-16 # Jenkins must have a Node.js installation named NodeJS-16 configured in
                          #  Manage Jenkins â†’ Global Tool Configuration â†’ NodeJS
    }
    stages {
        stage('Checkout'){
            steps {
                git url: 'https://github.com/Pathnex/sample-node-app.git' 
            }
        }
        stage('install Dependencies') {
            steps {
                sh 'npm install'
            }
        }
        stage('Run tests'){
            steps {
                sh 'npm test'
            }
        }
        stage('Build'){
            steps{
                sh 'npm run build'
            }
        }
    }
}

## ðŸ”¹ GitLab CI â€” NodeJS Build

stages:
  - install
  - test
  - build
node install:
  stage: install
  image:node:16
  script: 
    - git clone https://github.com/Pathnex/sample-node-app.git
    - cd sample-node-app
    - npm install
node test:
  stage: test
  imsage:node:16
  script:
    - cd sample-node-app
    - npm install

node test:          # Runs tests defined in package.json
  stage:test
  image:node:16
  script:
    - cd sample-node app
    - npm test

node build:         # Creates production-ready output ( /dist folder).
  stage: build
  image:node:16
  script:
    - cd sample-node-app
    - npm run build
